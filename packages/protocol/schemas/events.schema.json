{
  "$id": "https://schemas.instantpay.dev/events.schema.json",
  "title": "InstantPayEvent",
  "description": "Union of events emitted by the wallet to the dApp during the InstantPay lifecycle.",
  "oneOf": [
    {
      "type": "object",
      "required": ["type","request"],
      "properties": {
        "type": { "const": "show", "description": "Payment UI became visible to the user." },
        "request": { "$ref": "payment-request.schema.json", "description": "Full payment request associated with the event." }
      },
      "additionalProperties": false
    },
    {
      "type": "object",
      "required": ["type","request"],
      "properties": {
        "type": { "const": "click", "description": "User clicked the Pay button." },
        "request": { "$ref": "payment-request.schema.json", "description": "Full payment request associated with the event." }
      },
      "additionalProperties": false
    },
    {
      "type": "object",
      "required": ["type","request","boc"],
      "properties": {
        "type": { "const": "sent", "description": "Payment was sent; BOC is provided." },
        "request": { "$ref": "payment-request.schema.json", "description": "Full payment request associated with the event." },
        "boc": { "type": "string", "description": "Bag of Cells (serialized transaction)." }
      },
      "additionalProperties": false
    },
    {
      "type": "object",
      "required": ["type","request","reason"],
      "properties": {
        "type": { "const": "voided", "description": "Payment request was voided before click." },
        "request": { "$ref": "payment-request.schema.json", "description": "Full payment request associated with the event." },
        "reason": { "type": "string", "enum": ["hidden","replaced","expired","wallet"], "description": "Voided reason (pre-click)." }
      },
      "additionalProperties": false
    },
    {
      "type": "object",
      "required": ["type","request","reason"],
      "properties": {
        "type": { "const": "cancelled", "description": "Payment flow was cancelled." },
        "request": { "$ref": "payment-request.schema.json", "description": "Full payment request associated with the event." },
        "reason": { "type": "string", "enum": ["user","wallet","expired","unsupported_env"], "description": "Cancellation reason (post-click)." }
      },
      "additionalProperties": false
    }
  ]
}
