---
alwaysApply: true
---

# Обязательные правила для работы с репозиторием instant-pay

## 1) Всегда проверяй сборку после изменений

- После любых изменений кода немедленно запускай сборку из корня репозитория, чтобы убедиться, что нет ошибок типизации/сборки.
- Команда для запуска из корня, она уже рекурсивная:

```bash
pnpm run build
```

- Никогда не запускай сборку в dev или demo режиме. Только собирать можно.

- Любые ошибки компиляции/типизации считаются блокирующими и должны быть устранены перед продолжением.

## 2) Избегай операторов приведения типов в TypeScript

- Не используй `as` (а также angle-bracket casts и `!` non-null assertion). Строй типы так, чтобы компилятор TypeScript мог вывести/проверить их без приведения.
- Предпочитай:
  - Уточнение типов через сужение (type guards, проверки `typeof`, `in`, `Array.isArray`, пользовательские type predicate-функции)
  - Дженерики и корректные сигнатуры функций/интерфейсов
  - Явные типы только для публичных API; не дублируй очевидные типы там, где вывод работает сам
- Если кажется, что без приведения не обойтись, сначала перепиши код/типы так, чтобы этого не требовалось. Приведения типов — последний крайний вариант и по умолчанию запрещены.
- Учитывай, что версии TypeScript испольщзется 5.9.2, поэтому используй новые возможности TypeScript, не добавляй избыточных приведений.

## 3) Обновляй документацию

- Обновляй существующую документацию в соответствии с изменениями в коде.
- Не добавляй новую документацию, если она не нужна.
- Не удаляй документацию, если она нужна.


## 4) После удаления кода подчисти хвосты по проекту

- Если удаляешь сущности, которые могли использоваться глобально (функции, классы, типы, файлы, экспорты), обязательно:
  - Просканируй кодовую базу на оставшиеся упоминания (импорты/вызовы/реэкспорты) и удали их
  - Обнови связанные реэкспорты/индексные файлы
  - Пересобери проект (`pnpm run build --silent`) и устрани все ошибки
  - По необходимости обнови README/документацию, если поменялся публичный API

Рекомендованные проверки:
- Быстрый поиск по репозиторию (imports/uses) на имя удалённой сущности

## 5) Язык взаимодействия и комментариев

- Используй везде английский язык, в комментариях, документации, коде.
- Используй русский язык только в ответах на вопросы в чате.




